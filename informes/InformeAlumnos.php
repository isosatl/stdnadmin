<?php    //Script para determinar si se ha iniciado sessión y si es administrador.    if (session_id() == ''){        session_start();                    if (isset($_SESSION['privilegios'])){            if ($_SESSION['privilegios'] == 'admin'){                //mostrar contenido que corresponda a administrador                //print_r($_SESSION['privilegios']);                            }        }    }        if (!isset($_SESSION['usuario']) || (!isset($_SESSION['clave']))) {        $_SESSION['violation'] = 1;        header('Location: ./login.php');        exit();    } if (isset($_SESSION['timeout'])) {        $sessionTTL = time() - $_SESSION['timeout'];        if ($sessionTTL > $_SESSION['tiempoLimite']) {            $_SESSION['logedout'] = 1;            header('Location: ./login.php');            exit();        }    }    $_SESSION['timeout'] = time();    print_r($_SESSION);    include ROOT_DIR . '/includes/header.php';    include ROOT_DIR . '/includes/navinformes.php';?><body id="informes">    <!--div contenedor general-->    <div id="inf_contenedor">                <div id="Titulo_filtro">CONSULTAS DE ALUMNOS</div>                    <!--div contendor de los tres títulos de tipos de búsqueda        <div class="row" id="indicador_de_seleccion">            <table id="indicador_selecc_T">                <tr class="titulos_tr">                    <td class="secc_td" ><h4>Todos o por sección</h4></td>                    <td class="carr_td" ><h4>Por carrera y grado</h4></td>                    <td class="alumno_td" ><h4>Buscar por alumno</h4></td>                </tr>            </table>        </div>-->                    <!--div contenedor de todo el formulario-->        <div id="div_pa_formulario">            <form class="form_alumnos" name="frm" id="frm">                <div class="radios">                    <input class="tooltip" title="Alumnos pendientes de código personal" type="radio" class="radio_cls" value="cod_mineduc" name="filtrar">                    Pendiente código&nbsp;</input>                    <input class="tooltip" title="Alumnos pendientes de traslado" type="radio" class="radio_cls" value="estatus_mineduc" name="filtrar">                    Estatus en MINEDUC&nbsp;</input>                    <input class="tooltip" title="Alumnos que tienen expediente incompleto" type="radio" class="radio_cls" value="complecion_estatus" name="filtrar">                    Expediente incompleto&nbsp;</input>                    <input class="tooltip" title="Alumnos que son de nuevo ingreso" type="radio" class="radio_cls" value="es_nuevo_ingreso" name="filtrar">                    Es de nuevo ingreso</input>                    <input class="tooltip" title="todos los alumnos sin filtrar" type="radio" class="radio_cls" value="todos" name="filtrar">                    Todos sin filtrar</input><br />                    <input class="tooltip" title="Alumnos que tienen algún pendiente del grado anterior" type="radio" class="radio_cls" align="right" value="estatus_grd_anterior" name="filtrar">                    Algo pendiente en grados anteriores&nbsp;</input>                    <input class="tooltip" title="Alumnos menores de 16 años" type="radio" class="radio_cls" value="edad16" name="filtrar">                    Menores de 16 años&nbsp;</input>                    <input class="tooltip" title="Alumnos entre 16 y 18 años" type="radio" class="radio_cls" value="edad18" name="filtrar">                    Entre 16 y 18 añoss&nbsp;</input>                    <input class="tooltip" title="Alumnos mayores de 18 años" type="radio" class="radio_cls" value="edad19" name="filtrar">                    Mayor de 18 años&nbsp;</input>                </div>                                    <!--tabla para contener los cuatro ListBox-->                <table id="select_table" >                    <tr>                        <td id="secc_td">                            <select  class="tooltip" title="Seleccione una sección" class="ancho1" id="select-secc" name="select-secc" onfocus="select_secc_focus=1" >                                <option value="Default" selected="selected">Todos los alumnos</option>                            </select>                                               </td>                        <td class="carr_grd_td" id="carr_td_id">                            <select class="tooltip" title="Seleccione una carrera" id="select_carr" name="selec_carr" onfocus="select_secc_focus=2">                                <option value="Default" selected="selected">Seleccione una carrera</option>                            </select>                                               </td>                        <td class="carr_grd_td" id="grd_td_id">                            <select class="tooltip" title="Seleccione un grado" id="select_grd" name="selec_grd" onfocus="select_secc_focus=3">                                <option value="Default" selected="selected" >Seleccione un grado</option>                            </select>                                                                               </td>                        <td id="alumno_td">                            <input  class="tooltip" title="Ingrese el nombre de un alumno" onclick="limpiarElementos(this.form)" onFocus="limpiarElementos(this.form)" value="Nombre del alumno...?" type="text" size="25" id="service" name="service" >                            <input class="tooltip" title="Buscar este alumno" id="boton" type="button" value="Buscar" onClick="mostrarAlumno(service.value)" ></input>                                            </td>                    </tr>                </table>            </form>	                        <div id="suggestions" style="display: block "></div>                                            <!--div contenedor de la tabla que recive el contenido-->            <table id="T_secciones">            </table>                                        <!-- div para mostrar progreso de la carga o errores -->            <div id="info" ><img src="img/ajax-loader.gif"></div>            <div style = "border: 1px;" id="error"></div>        </div>                        <!--div contenedor-->                </div>             <!-- Pie de esta página -->    <div id="footer_container"></div>        <script type="text/javascript">            var encabezado = '';    encabezado = '<tr class="encabezado" id="id_encabezado"><td>Id alumno</td><td>Id sección</td><td>Id Grado</td><td>Id carreras</td><td>Nombres</td><td>Apellidos</td><td>Género</td><td>Edad</td></tr>';    $(document).ready(function(e){        //poblar listBox de secciones        fillSecciones();           $('#suggestions').hide();        //pobla el listBox de carreras        $.ajax({            type: 'POST',            dataType: 'json',            url: "dbInterfaces/InfAlumnosActions.php?action=fillcarrBox" ,            success: function(data){                var options = '';                for (var i = 0; i < data.length; i++){                    options += '<option value="' + data[i].id_carreras + '">' + data[i].nombre_carrera + '</option>';                            }                $("#select_carr").fadeIn('fast').append(options);                      },            error: function(error){                alert("hay un error");            },          });                //muestra todos los alumnos cuando la pú¡gina estú¡ lista           mostrarAlumnosInfo();                                });           $('select.tooltip').tooltip({        rounded: true    });    $('input.tooltip').tooltip({        rounded: true    });    /* al precionar una tecla sobre el input de alumno muestra los resultados de autocomplete*/    $('#service').one('keypress', function(){        $('#suggestions').animate({height:100, width:150, opacity: .75}, 1000, 'linear', function(){});                });        /* cuando el input box obtiene el foco, pierde la opacidad y aplica opacidad a las otroas opciones*/    $('#service').bind('focus', function(){        var aszTemp = (this.tagName).toLowerCase()        opacarOpcion(aszTemp);            });        /* al hacer click o enter sobre el botón buscar, desaparecen las sugerencias */    $('#boton').bind('click submit', function(){        $('#suggestions').slideUp(1000);            });        /* acción de auto completado*/    //Al escribr dentro del input con id="service"                    $('#service').keypress(function(){        //Obtenemos el value del input        var service = $(this).val();                var dataString = 'service='+service;                //Le pasamos el valor del input al ajax        $.ajax({            type: "POST",            url: "dbInterfaces/InfAlumnosActions.php?action=autoCompletado",            data: dataString,            cache: false,            success: function(data) {                                    //Escribimos las sugerencias que nos manda la consulta                $('#suggestions').slideDown(1000).html(data);                //Al hacer click en algua de las sugerencias                $('.suggest-element').live('click', function(){                    //Obtenemos la id unica de la sugerencia pulsada                    var id = $(this).attr('id');                    //Editamos el valor del input con data de la sugerencia pulsada                    $('#service').val($('#'+id).attr('data'));                    $('#suggestions').slideUp(1000);                    var aszTemp = (this.tagName).toLowerCase()                    opacarOpcion(aszTemp);                });                          }        });    });                  //muestra la información de alumnos al seleccionar una sección.    $("#select-secc").change(function(e){        //muestra todos los alumnos cuando la pú¡gina estú¡ lista           mostrarAlumnosInfo();                    opacarOpcion(select_secc_focus);    });        //pobla el listBox de grados	$("#select_carr").change(function(e){        opacarOpcion(select_secc_focus);                        //remueve opciones y inserta la option por defecto        $('#select_grd')        .find('option')        .fadeIn('fast')        .remove()        .end()        .append('<option value="Default">Seleccione un grado</option>')        ;        var id_carreras = document.getElementById('select_carr').value;	            console.log("Poblando los grados en base a la carrera: " + id_carreras);        $.ajax({            type: "POST",            dataType: "json",            data: '',            url: "dbInterfaces/InfAlumnosActions.php?action=fillgrdBox&id_carreras=" + id_carreras,            beforeSend: function(xhr){                xhr.setRequestHeader("Accept", "text/javascript");                $('#info').html('<img src="img/ajax-loader.gif" />');            },            success: function(data, textStatus, jqXHR){                var options = '';                for (var i = 0; i < data.length; i++){                    options += '<option value="' + data[i].id_grados + '">' + data[i].grado + '</option>';                            }                $("#select_grd").fadeIn('fast').append(options);                //$("#select_grd").val($("#select-secc option:first").val());                      },            complete: function () {                //$('#info').empty();                $('#error').empty();                $("#select_grd").focus();            },            error: function (response, request, error) {                $("#error").append("<option value=\"0\">No se encontró ningún dato</option>");                                              },        });	        });    //captura el evento al seleccionar una carrera y muesta los alumnos    $('#select_carr').bind('change',function (e) {        opacarOpcion(select_secc_focus);        mostrarAlumnosPorGrado();        });    //captura el evento al seleccionar grados y muestra los alumnos    $('#select_grd').bind('change',function (e) {        opacarOpcion(select_secc_focus);        mostrarAlumnosPorGrado();        });        //captura el evento sobre cada radio y extrae información seguún otros criterios    $('.radios').change(function(e){        if (select_secc_focus == 1){            console.log('select_seecc tiene el foco con valor: ' + select_secc_focus);            mostrarAlumnosInfo();                }else{            console.log('select_seecc ha perdido el foco con valor: ' + select_secc_focus);            mostrarAlumnosPorGrado();        }    });            </script>    </body></html>	